"""Demonstrates how to construct and send raw Ethernet packets on the
network.
You probably need root privs to be able to bind to the network interface,
e.g.:
    $ sudo python sendeth.py
"""

from socket import *
import time

def sendeth(src, dst, eth_type, payload, interface = "enp2s0"):
  """Send raw Ethernet packet on interface."""

  assert(len(src) == len(dst) == 6) # 48-bit ethernet addresses
  assert(len(eth_type) == 2) # 16-bit ethernet type

  s = socket(AF_PACKET, SOCK_RAW)

  # From the docs: "For raw packet
  # sockets the address is a tuple (ifname, proto [,pkttype [,hatype]])"
  s.bind((interface, 0))
  n= 0
  while(n<1000000):
      s.send(src + dst + eth_type + payload)
      n+=1
      time.sleep(0.000001)
  return s.send(src + dst + eth_type + payload)

if __name__ == "__main__":
    sendeth(b'\xFF\xFF\xFF\xFF\xFF\xFF',
            b'\xFE\xED\xFA\xCE\xBE\xEF',
            b'\x7A\x05',
            b'\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\x76\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF\xFE\xED\xFA\xCE\xBE\xEF')